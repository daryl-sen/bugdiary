{% macro ad(size) %}
<div class="sidebar-block bg-gray">
    <h3>Advertisement</h3>
    <p>
        No ads, yay!!
    </p>
</div>
{% endmacro %}

{% macro custom_style(header_color, background_color) %}
<style>
header {
    background-color: {{ header_color }};
}
nav, #nav:link, #logo {
    color: {{ header_text_color }} !important;
}

body {
    background-color: {{ background_color }};
    color: {{ text_color }};
}
.card {
    background-color: {{ card_color }};
}
aside {
    background-color: {{ aside_color }};
}
</style>
{% endmacro %}


{% macro search(suggestions) %}
<form action="{{ url_for('users.search') }}" method="get" class="lined block">
    <input name="search_term" type="text" list="project_names" placeholder="Enter a project name">
    <datalist id="project_names">
        {% for suggestion in suggestions %}
        <option value="{{suggestion.name}}">{{suggestion.name}} - {{suggestion.description[:20]}}</option>
        {% endfor %}
    </datalist>
    <input type="submit" value="Search" class="button-secondary">
</form>
{% endmacro %}



{% macro bugcard(ref_id, details, author, author_email, status, version, report_date, resolve_date, location, type, color_code = {"PENDING": "bg-yellow", "RESOLVED": "bg-green", "DELETED": 'bg-black', "PINNED": 'bg-red'}) %}
<div id="card-{{ref_id}}">
    <div class="card">
        <h2>#{{ref_id}}</h2>
        <div>
            <span class="tag-mini {{ color_code[status] }}">{{ status }}</span>
            
            <span class="tag-mini bg-gray">Loc: {{ location }}</span>
            <span class="tag-mini bg-gray">Type: {{ type }}</span>
            <span class="tag-mini">{{ version }}</span>
        </div>
        <h4>Description</h4>
        <p class="linebreak">{{ details }}</p>
        <div class="author">
            {% if author != "" or author_email != "" %}
            <b>Reported by:</b> {{ author }} (Email: {{ author_email }})
            {% endif %} <br>
            <b>Reported on:</b> {{ report_date.strftime('%Y-%m-%d') }}
            <br>
            {% if status == "RESOLVED" %}
            <b>Resolved on:</b> {{ resolve_date }}
            {% endif %}
        </div>
    
    
        <div class="cardcontrolstoggle" onClick="showControls('card-{{ref_id}}-controls')">
            &circledcirc;
        </div>
        <div class="hidden cardcontrols" id='card-{{ref_id}}-controls'>
            {% if status != "RESOLVED" %}
            <button onclick="fill_card_form('{{ref_id}}', 'resolve')">RESOLVE</button>
            {% endif %}
            {% if status != "PINNED" %}
            <button onclick="fill_card_form('{{ref_id}}', 'pin')">PIN &#x02606;</button>
            {% endif %}
            {% if status != "DELETED" %}
            <button onclick="fill_card_form('{{ref_id}}', 'delete')">DELETE &#128465;</button>
            {% endif %}
            <button onClick="showControls('card-{{ref_id}}-controls')" style="color: #ff3939">CANCEL &rarrhk;</button>
        </div>    
    </div>
</div>
{% endmacro %}




{% macro fetchapi() %}
<script>


function fill_card_form(button_id, action) {
    var instructions = {
        card: button_id,
        action: action
    };


    fetch(`{{ url_for('projects.manage_card') }}`, {
        method: "POST",
        credentials: "include",
        body: JSON.stringify(instructions),
        cache: "no-cache",
        headers: new Headers({
            "content-type": "application/json"
        })
    })
    .then(function(response) {
    if (response.status !== 200) {
        alert(`Looks like there was a problem. Status code: ${response.status}`);
        return;
    }
    response.json().then(function(data) {
        target_card = document.getElementById('card-' + button_id);
        target_card.style.visibility = "hidden";
        // target_card.innerHTML = "#" + button_id + " has been processed. Please refresh the page to see the change.";
    });
    })
    .catch(function(error) {
        alert("Fetch error: " + error);
    });
}

</script>
{% endmacro %}